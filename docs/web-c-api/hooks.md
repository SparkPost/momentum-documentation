Logged in as: OmniTI, Inc.  ([logout](https://support.messagesystems.com/logout.php))

[![Message Systems](https://support.messagesystems.com/images/ms-white205.png)](https://support.messagesystems.com/start.php) 

*   [Changelog](https://support.messagesystems.com/start.php?show=changelog)
*   [Documentation](https://support.messagesystems.com/docs/)
*   [Downloads](https://support.messagesystems.com/start.php)

*   [Licenses](https://support.messagesystems.com/license_summary.php)
*   <a href="">Clients</a>
    *   [Support](https://support.messagesystems.com/cs.php)
    *   [Add/Edit](https://support.messagesystems.com/edit_client.php)
    *   [Legal/Products](https://support.messagesystems.com/edit_products.php)
*   [Users](https://support.messagesystems.com/edit_customer.php)

## Search Help

Search for a single word or perform multi-word searches by enclosing your search in quotation marks.

Where you have multiple words but no quotation marks, an **OR** search is performed. For example, **"REST Injection"** searches for the phrase **"REST Injection"**, and, without quotation marks, searches for **REST OR Injection**--the operator is understood.

### Warning

You must escape the following special characters: **+ - && || ! ( ) { } [ ] ^ " ~ * ? : \**. Use the **\** character as the escape character. For example: **B0/00-11719-46C328D4\:default\:**

You can also perform **AND** searches, for example, **rest AND port** (no quotation marks) finds pages where both these words occur.

Terms used in searches are case-insensitive but operators are not. Alphabetic operators **must** be in uppercase.

Other operators can also be used. For more information see "[Query Parser Syntax](https://lucene.apache.org/core/old_versioned_docs/versions/3_0_0/queryparsersyntax.html)". Use of fields in searches is not currently supported.

| Part III. Hooks |
| [Prev](apis.ec_xmpp_session_send_stanza.php)  |   |  [Next](hooks.apn.php) |

## Part III. Hooks

## About Hooks

This part documents Momentum's hooking API. The most useful hook points are defined within the core of Momentum and are called "core hooks". These hooks are found at [Chapter 60, *Hooks in the core scope*](hooks.core.php "Chapter 60. Hooks in the core scope") . You can use these predefined hook points from custom modules. To do this, you must create a module and that module must define a function that is registered with the desired hook point. If you are familiar with using Lua with Momentum, the [registerModule](https://support.messagesystems.com/docs/web-ref/lua.ref.msys.registerModule.php) function performs registration for a Lua script.

Hook points are registered in a singleton module's `conf_setup` function or, for non-singleton modules, in the `ext_init` function. [Section 1.3.1, “Module API”](arch.primary.apis.php#arch.module "1.3.1. Module API") describes these functions in detail. As an example, if you are creating a singleton module and wanted to perform certain actions on shutdown, from within `conf_setup` call `register_core_control_shutdown_hook_first` (or last) passing in a function pointer and a closure. The referenced function must be defined within your module code and the closure is typically a reference to your custom module (a [generic_module_infrastructure](structs.generic_module_infrastructure.php "68.53. generic_module_infrastructure")). The closure that you supply when registering a function will be passed as the first parameter when the hook point arrives.

All hook points have "has", "register" and "call" functions that are generated by the `EC_DECLARE_VOID_HOOK` or `EC_DECLARE_HOOK` macro described at [EC_DECLARE_HOOK](apis.ec_declare_hook.php "EC_DECLARE_HOOK"). Hook "has" and "call" routines also provide a `_txn` version. The "call" routine returns a "transactional" module infrastructure that is guaranteed to be valid for the life of the hook invocation allowing you to write custom module code such as the following:

```
ec_config_header *global_conf = ec_config_fetch_globalconf();
generic_module_infrastructure *self = call_mymodule_get_module_closure_txn(global_conf);
register_mymodule_get_module_closure_hook_first(get_closure, self);
...
```

Using the `_txn` hook consumer guarantees that the value returned will remain valid until the configuration is released. This is exactly the same idiom that the hooking infrastructure itself uses when calling hooks and that's how it guarantees that the configuration and module infrastructure is valid for the life of the hook invocation.

To use an existing built-in Momentum hook point you must invoke the "register" function associated with it and you must know the following:

*   The hook name.

*   When the hook occurs.

*   Whether the hook has a return value.

*   Which thread the hook can be invoked from.

*   Any special circumstances related to that hook.

The hook API is discussed in detail at [Section 1.3.2, “Hooking API”](arch.primary.apis.php#arch.hooking "1.3.2. Hooking API"). If you wish to create hooks for a custom module see [EC_DECLARE_HOOK](apis.ec_declare_hook.php "EC_DECLARE_HOOK").

### Note

All hooks related to SMPP and MM7 are documented in [Mobile Momentum Developer Guide](https://support.messagesystems.com/docs/web-mob-dev/).

Some of the hooks documented here have been created manually and others have been generated automatically from source code. Automatic documentation is noted as such.

**Table of Contents**

<dl class="toc">

<dt>[58\. Hooks in the apn Scope](hooks.apn.php)</dt>

<dt>[59\. Hooks in the cluster Scope](hooks.cluster.php)</dt>

<dt>[60\. Hooks in the core scope](hooks.core.php)</dt>

<dt>[61\. Hooks in the delay_dsn Scope](hooks.delay_dsn.php)</dt>

<dt>[62\. Hooks in the gcm Scope](hooks.gcm.php)</dt>

<dt>[63\. Hooks in the generic_delivery and httpclnt Scope](hooks.generic_delivery.php)</dt>

<dt>[64\. Hooks in the msgc Scope](hooks.msgc.php)</dt>

<dt>[65\. Hooks in the publish Scope](hooks.publish.php)</dt>

<dt>[66\. Hooks in the restinj Scope](hooks.restinj.php)</dt>

<dt>[67\. Hooks in the sieve scope](hooks.sieve.php)</dt>

</dl>

| [Prev](apis.ec_xmpp_session_send_stanza.php)  |   |  [Next](hooks.apn.php) |
| ec_xmpp_session_send_stanza  | [Table of Contents](index.php) |  Chapter 58. Hooks in the apn Scope |

Follow us on:

[![Facebook](https://support.messagesystems.com/images/icon-facebook.png)](http://www.facebook.com/messagesystems) [![Twitter](https://support.messagesystems.com/images/icon-twitter.png)](http://twitter.com/#!/MessageSystems) [![LinkedIn](https://support.messagesystems.com/images/icon-linkedin.png)](http://www.linkedin.com/company/message-systems)