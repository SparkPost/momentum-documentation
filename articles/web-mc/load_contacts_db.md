Logged in as: OmniTI, Inc.  ([logout](https://support.messagesystems.com/logout.php))

[![Message Systems](https://support.messagesystems.com/images/ms-white205.png)](https://support.messagesystems.com/start.php) 

*   [Changelog](https://support.messagesystems.com/start.php?show=changelog)
*   [Documentation](https://support.messagesystems.com/docs/)
*   [Downloads](https://support.messagesystems.com/start.php)

*   [Licenses](https://support.messagesystems.com/license_summary.php)
*   <a href="">Clients</a>
    *   [Support](https://support.messagesystems.com/cs.php)
    *   [Add/Edit](https://support.messagesystems.com/edit_client.php)
    *   [Legal/Products](https://support.messagesystems.com/edit_products.php)
*   [Users](https://support.messagesystems.com/edit_customer.php)

## Search Help

Search for a single word or perform multi-word searches by enclosing your search in quotation marks.

Where you have multiple words but no quotation marks, an **OR** search is performed. For example, **"REST Injection"** searches for the phrase **"REST Injection"**, and, without quotation marks, searches for **REST OR Injection**--the operator is understood.

### Warning

You must escape the following special characters: **+ - && || ! ( ) { } [ ] ^ " ~ * ? : \**. Use the **\** character as the escape character. For example: **B0/00-11719-46C328D4\:default\:**

You can also perform **AND** searches, for example, **rest AND port** (no quotation marks) finds pages where both these words occur.

Terms used in searches are case-insensitive but operators are not. Alphabetic operators **must** be in uppercase.

Other operators can also be used. For more information see "[Query Parser Syntax](https://lucene.apache.org/core/old_versioned_docs/versions/3_0_0/queryparsersyntax.html)". Use of fields in searches is not currently supported.

| load_contacts_db.pl |
| [Prev](executable-commands.php)  | Chapter 8. Message Central Commands |  [Next](mclog_loader.php) |

<a name="load_contacts_db"></a>
## Name

load_contacts_db.pl — bulk load contacts into the database

## Synopsis

`/opt/msys/pe2/bin/load_contacts_db.pl` [ -a | --audituserid { *`ID`* } ]

`/opt/msys/pe2/bin/load_contacts_db.pl` [ -b | --batch [ *`batch_size`* ] ]

`/opt/msys/pe2/bin/load_contacts_db.pl` [ -c | --config { *`import_config_file`* } ]

`/opt/msys/pe2/bin/load_contacts_db.pl` [ -d | --data-only [ Yes | No ] ]

`/opt/msys/pe2/bin/load_contacts_db.pl` [ -f | --file [ *`path/to/file`* ] ]

`/opt/msys/pe2/bin/load_contacts_db.pl` [ -g | --groups { *`group_name, ...`*      } ]

`/opt/msys/pe2/bin/load_contacts_db.pl` [ -h | --help ]

`/opt/msys/pe2/bin/load_contacts_db.pl` [ --import-charset { *`character_set_encoding`* } ]

`/opt/msys/pe2/bin/load_contacts_db.pl` { -i | --input [ *`file.csv`* ] }

`/opt/msys/pe2/bin/load_contacts_db.pl` [ -k { *`column, column, ...`*              } ]

`/opt/msys/pe2/bin/load_contacts_db.pl` [ -l | --pidfile { *`file_name`* } ]

`/opt/msys/pe2/bin/load_contacts_db.pl` [ -m | mode { Add | AddUpdate | Update | FastAdd } ]

`/opt/msys/pe2/bin/load_contacts_db.pl` { -o | -- orgid { *`org_id`* } }

`/opt/msys/pe2/bin/load_contacts_db.pl` [ -p | --profile [ Yes | No ] ]

`/opt/msys/pe2/bin/load_contacts_db.pl` [ -s | --source [ *`datasource`* ] ]

`/opt/msys/pe2/bin/load_contacts_db.pl` [ -t | --tags { *`tag_name, ...`*      } ]

`/opt/msys/pe2/bin/load_contacts_db.pl` [ --tld-validate [ Yes | No ] ]

`/opt/msys/pe2/bin/load_contacts_db.pl` [ -u | --usage ]

`/opt/msys/pe2/bin/load_contacts_db.pl` [ -v [ 0 | 1 | 2 |3 | 4 ] ]

`/opt/msys/pe2/bin/load_contacts_db.pl` [ -x { Yes | No } ]

<a name="idp1297152"></a>
## Description

The **load_contacts_db.pl** command is the preferred method for regularly importing recipient data. This command imports contacts into the database directly. Options may be specified on the command line in short or long form, or in the import configuration file. For a description of the import configuration file see [the section called “Import Configuration File”](load_contacts_db.php#load_contacts_db.import.config "Import Configuration File"). Command-line options override configuration file options.

### Note

You can also import CSV files using the web UI. For more information see ["Importing Lists"](https://support.messagesystems.com/docs/web-mc-user/mc3-recipients-importing.php) .

Prior to version 3.6, only CSV files encoded with Latin ISO-8859-1 would import correctly. In version 3.6 and later, you can import, for instance, a CSV file generated by Mac Excel directly by specifying `--import-charset 'macroman'`.

Recipients that do not possess the unique key fields defined for an org cannot be imported. For more information see ["Unique Key Fields"](https://support.messagesystems.com/docs/web-mc-user/mc3-administration.php#mc3-administration-orgs-key-fields).

To import contacts into an org with the ID of `1` from a file in the current directory named `recipients.csv` issue the command:

`shell> /opt/msys/pe2/bin/load_contacts_db.pl -i recipients.csv -o 1`

The input file must be in CSV format with the first line of the file must contain the field name of each column. Each line must be terminated by a newline character or importation will fail. The following fields are supported as basic contact fields, extra fields can be added as profile data fields:

```
"localpart", "domain", "firstname", "lastname",
"birthdate", "gender", "address1", "address2", "phone1",
"phone2", "city", "region", "postalcode", "countrycode",
"languagecode", "contenttype".
```

The virtual field "email" may also be provided; it will be split into the local part and domain automatically.

### Note

As of version 3.6, records with illegal email addresses will not be imported and an error message will be output.

As of version 3.7, the following fields are also supported:

*   `sms_contact` – use this text field for an E.164 compliant phone number

*   `sms_subscribed` – whether or not a recipient is subscribed to SMS content. The default value for this field is `t`.

Existing profile data fields may also be used. Simply name the column using the name of the profile field. Be sure to use quotation marks if the profile data field name contains spaces or commas.

If you want to add extra contact properties in addition to the above supported properties, profile fields may be created. If a column is present with an unrecognized name, it will be created as a text-type profile field. You can disable this feature by specifying the `-p No` command line option. To create new profile fields, create an import configuration file for use with the `-c` option, and specify sections named after each new field, with a `Type` value of "text", "number" or "date".

The following is an example of an input file that contains the header line and one line of contact information:

```
"email","localpart","domain","firstname","lastname","birthdate","gender","address1", ’
  "address2","phone1","phone2","city","region","postalcode","countrycode","languagecode","contenttype"
"mike.johnson@example.com",,,"Mike","Johnson",08/08/08,"M","Suite 200","100 broad way", ’
  "410-5555555","410-5556666","Columbia","Maryland",20000,"US","EN","html"
```

If you wish to skip a column in your CSV file, simply enter a ‘`,`’ and no field name.

The following exit values apply:

*   `0` Normal exit

*   `1` Usage/options error

*   `2` Importer config file error

*   `3` DB connect error

*   `4` Header parse/Column mapping error

The configuration options are as follows:

<dl class="variablelist">

<dt>-a | --audituserid { *`ID`* }</dt>

<dd>

Specify the ID of the user importing the contacts. This user information is stored with the Contact data. The ID must be an integer. The import configuration file option name is `AuditUserID`.

</dd>

<dt>-b | --batch { *`batch_size`* }</dt>

<dd>

Specify the batch size when doing bulk updates. The script will attempt to combine queries to affect up to *`batch_size`* rows at a time. The default value for this option is `200`. The import configuration file option name is `BatchSize`.

</dd>

<dt>-c | --config { *`file_name`* }</dt>

<dd>

Specify an import configuration file. Optional. See [the section called “Import Configuration File”](load_contacts_db.php#load_contacts_db.import.config "Import Configuration File") for the file format.

</dd>

<dt>-d --data-only [ Yes | No ]</dt>

<dd>

Specify that the first row is data, not a header row. You must specify an import configuration file with `CSVColumnNumber` mappings. The default value is `No`. The import configuration file option name is `FirstRowIsData`.

</dd>

<dt>-f | --file [ *`/path/to/file`* ]</dt>

<dd>

Specify the Message Central configuration file. This option is used to connect to the database. The default is `/opt/msys/pe2/etc/pe2.conf`. The import configuration file option name is `PE2ConfigFile`.

</dd>

<dt>-g | --groups { *`preference_group_name, ...`*      }</dt>

<dd>

A comma-separated list of Preference Groups to add to all contacts. See also -x. The import configuration file option name is `Groups`.

</dd>

<dt>-h | --help</dt>

<dd>

Print the help message and exit.

</dd>

<dt>--import-charset { *`character_set_encoding`* }</dt>

<dd>

Specify a character set. The default value is `utf8`.

This option supports any encoding supported by the Perl Encode package. This script will exit with the message: "unsupported encoding" if the Perl Encode cannot handle the encoding. There is no import configuration file option for this item.

</dd>

<dt>-i | --input [ *`file_name`* ]</dt>

<dd>

Specify the CSV input file containing the data. The default is standard input. The import configuration file option name is `InputFile`.

</dd>

<dt>-k | --key-columns { *`column,column,... }`* </dt>

<dd>

Specify which columns to use to decide whether an entry is a duplicate or not. Not used in Add mode. The import configuration file option name is `KeyColumns`.

Specify a comma-separated list of database column names. Do not use spaces on the command line, though you may use them in the import configuration file. The default value is `localpart,domain` (which gives the effect of matching on email).

</dd>

<dt>-l | --pidfile { *`file_name`* }</dt>

<dd>

Specify the full path to the process ID file.

</dd>

<dt>-m | --mode [ Add | AddUpdate | Update | FastAdd ]</dt>

<dd>

Mode must be one of the following settings:

*   Add – Create a new record for each row. May result in duplicates.

*   Update – Update existing records, ignore non-existing records.

*   AddUpdate – Update existing records, create non-existing records.

*   FastAdd – Create a new record for each row without checking for existing records. This mode is to be used only if user is sure that the input file contains only new records. This mode would be faster as it does not check for existing records based on unique key. However it may result in duplicate records if the input file actually contains lines matching existing records. This option is available as of version 3.2.

The default value is `AddUpdate`. The import configuration file option name is `ImportMode`.

</dd>

<dt>-o |--orgid { *`number`* }</dt>

<dd>

Specify the Organization ID into which contacts should be imported. This option is required. The import configuration file option name is `OrgID`.

To determine the Organization ID, go to the Manage Orgs page of the Administration menu option. The ID of the Organization added during installation is `1`. The import configuration file option name is `OrgID`.

</dd>

<dt>-p | --profile [ Yes | No ]</dt>

<dd>

Specify whether to create new profile fields for unrecognized columns. You may specify a type for the new profile field using the mapping facility, otherwise the type will default to "text". The default value is `Yes`. The import configuration file option name is `CreateNewProfileFields`.

</dd>

<dt>-s | --source [ *`datasource_name`* ]</dt>

<dd>

Specify a datasource name that will be stored in the database. The default value is `Unknown Source`. The import configuration file option name is `DataSource`.

</dd>

<dt>-t | --tags { *`tag_name`*, ... }</dt>

<dd>

Synonym for -g. The import configuration file option name is `Tags`.

</dd>

<dt>--tld-validate [ Yes | No ]</dt>

<dd>

Specify whether to validate a mail address’ top level domains. The default value is `No`. The import configuration file option name is `TLDValidate`.

</dd>

<dt>-u | --usage</dt>

<dd>

Print the help message and exit.

</dd>

<dt>-v | --verbose [ 0 | 1 | 2 | 3 | 4 ]</dt>

<dd>

How much status information to print to standard output. Values: 0 (silent), 1 (default), 2 (detailed init), 3 (per-line), 4 (debug). the default value is `2`. The import configuration file option name is `Verbosity`.

</dd>

<dt>-x [ Yes | No ]</dt>

<dd>

Used with -g. Specifies what to do when an unrecognized Preference Group is encountered. If the value is Yes, a new group is created; if the value is No, the group is not created, and contacts are not added to the group. The default value is `Yes`. The import configuration file option name is `CreateNewPreferenceGroups`.

</dd>

</dl>

<a name="load_contacts_db.import.config"></a>
## Import Configuration File

The import configuration file uses INI format. You may specify the named version of the command line options (as listed above) as global values in the file, as well as define field mappings:

```
# corresponds to the -b option above
BatchSize = 200
KeyColumns = localpart,domain

# field mappings:
# Assuming that you have defined (or want to define) a profile field
# named "shoesize" and that field is in the EuropeanShoeSize column
# of CSV data:

[shoesize]
# Type only applies when creating a new profile field.
# You may choose from "text", "number" or "date".
# "text" is the default.
Type = number
# If your CSV file has a header row, then define CSVColumnName to the
# name of the column that contains the data
CSVColumnName = EuropeanShoeSize
# Otherwise, you may use CSVColumnNumber to reference a
# numbered column.
# CSVColumnNumber = 1
```
<a name="idp1588704"></a>
## See Also

"[Recipients](https://support.messagesystems.com/docs/web-mc-user/mc3-recipients.php)"

| [Prev](executable-commands.php)  | [Up](executable-commands.php) |  [Next](mclog_loader.php) |
| Chapter 8. Message Central Commands  | [Table of Contents](index.php) |  mclog_loader |

Follow us on:

[![Facebook](https://support.messagesystems.com/images/icon-facebook.png)](http://www.facebook.com/messagesystems) [![Twitter](https://support.messagesystems.com/images/icon-twitter.png)](http://twitter.com/#!/MessageSystems) [![LinkedIn](https://support.messagesystems.com/images/icon-linkedin.png)](http://www.linkedin.com/company/message-systems)